import{k as c,A as C,I as b,m as k,o as m,f as D,i as L,q as S,b as g,F as B,s as V,p as q,t as T}from"./app-219f245d.js";import{C as z}from"./auto-5842a5d9.js";const A=g("option",{value:"all"},"全て",-1),F=["value"],_="all",R={__name:"LineGraph",props:["quizRecords","fromDate","toDate"],setup(h){const{quizRecords:o,fromDate:i,toDate:u}=h,d=c(null),l=c(null),y=c([]),a=c(_);async function w(){try{const e=await q.get("/api/categories");y.value=e.data}catch(e){console.error("カテゴリー情報の取得に失敗しました",e)}}C(()=>f(o),e=>{v(e)}),b(()=>{a.value=_});function f(e){if(!i&&!u)return e;const r=i?new Date(i).getTime():0,t=u?new Date(u).getTime():Date.now();return e.filter(p=>{const s=new Date(p.created_at).getTime();return s>=r&&s<=t})}function v(e){if(!d.value||(l.value&&(l.value.destroy(),l.value=null),e.length===0))return;const r=a.value==="all"?e:e.filter(n=>n.category_id===a.value),t=r.map(n=>n.accuracy),p=r.map(n=>new Date(n.created_at).toLocaleDateString()),s=d.value.getContext("2d");l.value=new z(s,{type:"line",data:{labels:p,datasets:[{label:"正答率",data:t,borderColor:"rgb(75, 192, 192)",tension:.1}]},options:{scales:{x:{title:{display:!0,text:"日付"},reverse:!0},y:{title:{display:!0,text:"正答率 (%)"}}}}})}function x(){return a.value==="all"?o:o.filter(e=>e.category_id===a.value)}return k(async()=>{await w(),v(f(o))}),C(a,()=>{v(f(x()))}),(e,r)=>(m(),D("div",null,[L(g("select",{"onUpdate:modelValue":r[0]||(r[0]=t=>a.value=t)},[A,(m(!0),D(B,null,V(y.value,t=>(m(),D("option",{key:t.id,value:t.id},T(t.name),9,F))),128))],512),[[S,a.value]]),g("canvas",{ref_key:"lineChartCanvas",ref:d},null,512)]))}};export{R as default};
