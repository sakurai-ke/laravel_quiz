import{k as u,o as m,f as p,i as n,l as S,b as e,F as g,j as V,m as $,p as d,a as b,u as U,w,g as h,e as j,q as A,s as D,t as L,x as c}from"./app-ce9a988c.js";import{_ as Q}from"./AuthenticatedLayout-c0a32526.js";import{Z as O}from"./index.esm-2de91299.js";import{_ as q}from"./ValidationErrors-3f272b23.js";import"./ApplicationLogo-a6dd6562.js";import"./_plugin-vue_export-helper-c27b6911.js";const B={class:"fixed inset-0 flex items-center justify-center z-50","aria-hidden":"true"},N=e("svg",{class:"w-6 h-6",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24",xmlns:"http://www.w3.org/2000/svg"},[e("path",{strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:"2",d:"M6 18L18 6M6 6l12 12"})],-1),E=[N],F=V('<header class="modal__header flex justify-between items-center px-4 py-2 bg-gray-100 rounded-t-lg mt-4"><h2 class="modal__title text-lg font-semibold text-gray-800"><span class="font-bold text-blue-700">クイズ編集ヘルプ</span><br></h2></header><main class="modal__content p-4 text-gray-700"><p class="mb-4"><span class="font-bold text-blue-700">カテゴリーの選択:</span><br> 編集するクイズのカテゴリーを選択します。変更する場合、適切なカテゴリーを選んでください。 </p><p class="mb-4"><span class="font-bold text-blue-700">問題文の編集:</span><br> 「問題文」のテキストボックスに、新しい問題文を入力します。ユーザーに提示するクイズの問題文をここで編集します。 </p><p class="mb-4"><span class="font-bold text-blue-700">正解の設定:</span><br> 「正解」のテキストボックスに、クイズの正しい答えを入力します。 </p><p class="mb-4"><span class="font-bold text-blue-700">正解以外の選択肢の設定:</span><br> 正解以外の「選択肢1」「選択肢2」「選択肢3」のテキストボックスに、クイズの選択肢を入力します。 </p><p class="mb-4"><span class="font-bold text-blue-700">解説の編集:</span><br> 「解説」のテキストエリアに、クイズの解説文を入力します。ユーザーがクイズに回答した後に 提供する追加情報や説明をここで編集します。 </p><p class="mb-4"><span class="font-bold text-blue-700">画像のアップロード:</span><br> 「画像ファイル」セクションで、クイズに関連付けたい画像をアップロードできます。選択した 画像はクイズの一部として表示されます。 アップロード済みの画像を削除する場合は「画像を削除」ボタンをクリックします。 </p><p class="mb-4"><span class="font-bold text-blue-700">クイズの更新:</span><br> 全ての情報を入力し、クイズを更新する場合は「更新」ボタンをクリックします。 </p><p class="mb-4"><span class="font-bold text-blue-700">クイズの削除:</span><br> クイズを完全に削除するために「削除」ボタンをクリックします。実際に削除される前に削除確認のための ダイアログが表示されます。 </p></main>',2),R={__name:"EditModal",setup(f){const t=u(!1),r=()=>{t.value=!t.value},i=a=>{a.target.classList.contains("modal__overlay")&&r()};return(a,v)=>(m(),p(g,null,[n(e("div",B,[e("div",{class:"modal fixed inset-0 flex items-center justify-center z-50"},[e("div",{onClick:i,class:"modal__overlay fixed inset-0 bg-opacity-50 bg-black"}),e("div",{class:"modal__container bg-white rounded-lg shadow-lg max-w-md mx-auto p-4 z-50 relative",role:"dialog","aria-modal":"true","aria-labelledby":"modal-1-title"},[e("button",{onClick:r,type:"button",class:"modal__close absolute top-4 right-4 focus:outline-none text-gray-500 hover:text-gray-700"},E),F,e("footer",{class:"modal__footer px-4 py-2"},[e("button",{onClick:r,type:"button",class:"modal__btn modal__btn-primary bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded focus:outline-none mr-2"}," 閉じる ")])])])],512),[[S,t.value]]),e("button",{onClick:r,type:"button",class:"bg-blue-500 hover:bg-blue-600 text-white font-semibold py-2 px-4 rounded focus:outline-none"},"ヘルプ")],64))}},T=e("h2",{class:"font-semibold text-2xl text-gray-800 leading-tight"},"クイズ編集",-1),H={class:"absolute top-40 right-4 z-50"},P={class:"bg-gray-100 py-8"},W={class:"max-w-3xl mx-auto px-4"},Z=e("h2",{class:"text-2xl font-semibold mb-4"},"クイズ編集",-1),G=["innerHTML"],J=["onSubmit"],K={class:"bg-white rounded shadow-md p-4"},X={class:"mb-4"},Y=e("label",{for:"category",class:"block font-semibold mb-1"},"カテゴリー:",-1),ee=["value"],te={class:"mb-4"},se=e("label",{for:"title",class:"block font-semibold mb-1"},"問題文:",-1),oe={class:"mb-4"},le=e("label",{for:"correctAnswer",class:"block font-semibold mb-1"},"正解:",-1),ae={class:"mb-4"},ne=e("label",{for:"wrongAnswer1",class:"block font-semibold mb-1"},"選択肢1:",-1),re={class:"mb-4"},ie=e("label",{for:"wrongAnswer2",class:"block font-semibold mb-1"},"選択肢2:",-1),de={class:"mb-4"},ce=e("label",{for:"wrongAnswer3",class:"block font-semibold mb-1"},"選択肢3:",-1),ue={class:"mb-4"},me=e("label",{for:"explain",class:"block font-semibold mb-1"},"解説:",-1),pe={class:"mb-4"},be=e("label",{for:"image",class:"block font-semibold mb-1"},"画像ファイル:",-1),_e={key:0,class:"mt-2"},ge=["src"],fe=e("div",{class:"mt-4"},[e("button",{type:"submit",class:"bg-blue-500 text-white px-4 py-2 rounded"},"更新")],-1),ze={__name:"Edit",props:{errors:Object},setup(f){const t=u({id:null,category_id:null,title:"",correct_answer:"",wrong_answer_1:"",wrong_answer_2:"",wrong_answer_3:"",explain:"",image_src:""}),r=u([]),i=u(null),a=u(null);$(()=>{const o=window.location.pathname.split("/").slice(-2)[0];console.log("Quiz ID:",o),x(o),v()});async function v(){try{const o=await d.get("/api/categories");r.value=o.data}catch(o){console.error("カテゴリーの取得に失敗しました",o)}}async function x(o){try{console.log("Quiz ID:",o);const s=await d.get(`/api/editQuizzes/${o}`);console.log("API Response:",s.data),t.value=s.data.quiz,t.value.image_src&&(a.value="/storage/images/"+t.value.image_src)}catch(s){console.error("クイズの詳細情報の取得に失敗しました",s)}}const _=u(null);async function y(){try{if(i.value){const s=new FormData;s.append("image_src",i.value);const M=(await d.post("/api/uploadImage",s)).data.image_src;t.value.image_src=M}const o=await d.put(`/api/updateQuizzes/${t.value.id}`,t.value);console.log("クイズ送信成功:",o),o.data.message==="クイズが更新されました"&&(localStorage.setItem("flashMessage","クイズが更新されました"),window.location.href="/list")}catch(o){console.error("クイズの更新に失敗しました",o),o.response.data.errors&&(_.value=Object.values(o.response.data.errors).join("<br>"))}}function k(o){const s=o.target.files[0];i.value=s,a.value=URL.createObjectURL(s)}async function z(){i.value=null,a.value=null,t.value.image_src="";try{await d.delete(`/api/deleteImage/${t.value.id}`),console.log("画像ファイルを削除しました")}catch(o){console.error("画像ファイルの削除に失敗しました",o)}}async function I(){try{(await d.delete(`/api/quizzes/${t.value.id}`)).data.message==="クイズが削除されました"&&(localStorage.setItem("flashMessage","クイズが削除されました"),window.location.href="/list")}catch(o){console.error("クイズの削除に失敗しました",o)}}function C(){confirm("本当にクイズデータを削除しますか？")?I():event.preventDefault()}return(o,s)=>(m(),p(g,null,[b(U(O),{title:"クイズ編集"}),b(Q,null,{header:w(()=>[T]),default:w(()=>[e("div",H,[b(R)]),e("div",P,[e("div",W,[Z,b(q,{errors:f.errors},null,8,["errors"]),_.value?(m(),p("div",{key:0,class:"mb-4 text-red-600",innerHTML:_.value},null,8,G)):h("",!0),e("form",{onSubmit:j(y,["prevent"]),enctype:"multipart/form-data"},[e("div",K,[e("div",X,[Y,n(e("select",{"onUpdate:modelValue":s[0]||(s[0]=l=>t.value.category_id=l),id:"category",class:"w-full rounded-md p-2 border"},[(m(!0),p(g,null,D(r.value,l=>(m(),p("option",{key:l.id,value:l.id},L(l.name),9,ee))),128))],512),[[A,t.value.category_id]])]),e("div",te,[se,n(e("input",{"onUpdate:modelValue":s[1]||(s[1]=l=>t.value.title=l),id:"title",type:"text",class:"w-full rounded-md p-2 border"},null,512),[[c,t.value.title]])]),e("div",oe,[le,n(e("input",{"onUpdate:modelValue":s[2]||(s[2]=l=>t.value.correct_answer=l),id:"correctAnswer",type:"text",class:"w-full rounded-md p-2 border"},null,512),[[c,t.value.correct_answer]])]),e("div",ae,[ne,n(e("input",{"onUpdate:modelValue":s[3]||(s[3]=l=>t.value.wrong_answer_1=l),id:"wrongAnswer1",type:"text",class:"w-full rounded-md p-2 border"},null,512),[[c,t.value.wrong_answer_1]])]),e("div",re,[ie,n(e("input",{"onUpdate:modelValue":s[4]||(s[4]=l=>t.value.wrong_answer_2=l),id:"wrongAnswer2",type:"text",class:"w-full rounded-md p-2 border"},null,512),[[c,t.value.wrong_answer_2]])]),e("div",de,[ce,n(e("input",{"onUpdate:modelValue":s[5]||(s[5]=l=>t.value.wrong_answer_3=l),id:"wrongAnswer3",type:"text",class:"w-full rounded-md p-2 border"},null,512),[[c,t.value.wrong_answer_3]])]),e("div",ue,[me,n(e("textarea",{"onUpdate:modelValue":s[6]||(s[6]=l=>t.value.explain=l),id:"explain",type:"text",class:"w-full rounded-md p-2 border"},null,512),[[c,t.value.explain]])]),e("div",pe,[be,e("input",{type:"file",id:"image",onChange:k,accept:"image/*"},null,32),a.value?(m(),p("div",_e,[e("img",{src:a.value,alt:"選択した画像",class:"max-h-40"},null,8,ge),e("button",{type:"button",onClick:z,class:"mt-2 text-sm text-red-500 hover:text-red-700"}," 画像を削除 ")])):h("",!0)])]),fe,e("div",{class:"mt-4"},[e("button",{onClick:C,class:"bg-red-500 text-white px-4 py-2 rounded"},"削除")])],40,J)])])]),_:1})],64))}};export{ze as default};
